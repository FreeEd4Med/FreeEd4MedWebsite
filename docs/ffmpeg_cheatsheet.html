<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FFmpeg Cheat Sheet ‚Äî FreeEd4Med Media SuperTool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="../style.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      line-height: 1.6;
      background: #0f0f1f;
      color: #f0f0f0;
      margin: 0;
      padding: 0;
    }
    .cheatsheet-container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 2rem;
      position: relative;
    }
    .cheatsheet-container::before {
      content: '';
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 450px;
      height: 450px;
      background: url('../images/logo.png') center/contain no-repeat;
      opacity: 0.03;
      pointer-events: none;
      z-index: -1;
    }
    .cheatsheet-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 0;
      border-bottom: 2px solid rgba(241, 196, 15, 0.4);
      margin-bottom: 2rem;
      position: sticky;
      top: 0;
      background: rgba(15, 15, 31, 0.93);
      backdrop-filter: blur(8px);
      z-index: 10;
    }
    .cheatsheet-header .links a {
      color: #f1c40f;
      text-decoration: none;
      font-weight: bold;
      padding: 0.5rem 1rem;
      border: 2px solid #f1c40f;
      border-radius: 5px;
      transition: all 0.3s;
      margin-left: 0.5rem;
    }
    .cheatsheet-header .links a:hover {
      background: #f1c40f;
      color: #111;
    }
    h1, h2, h3, h4 {
      color: #f1c40f;
      margin-top: 2rem;
    }
    h2 { border-bottom: 1px solid rgba(241, 196, 15, 0.3); padding-bottom: 0.3rem; }
    h3 { color: #1abc9c; }
    h4 { color: #3498db; }
    .toc {
      background: rgba(52, 152, 219, 0.1);
      border-left: 4px solid #3498db;
      padding: 1.5rem;
      margin: 2rem 0;
    }
    .toc a { color: #1abc9c; text-decoration: none; }
    .toc ul { list-style: none; padding-left: 0; }
    .toc li { margin: 0.5rem 0; }
    pre {
      background: #1b1b2f;
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 6px;
      padding: 1rem;
      overflow-x: auto;
      font-size: 0.95rem;
      margin: 1rem 0;
    }
    code { font-family: 'Fira Code', 'Source Code Pro', monospace; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      font-size: 0.95rem;
    }
    th, td {
      border: 1px solid rgba(255,255,255,0.1);
      padding: 0.75rem 1rem;
    }
    th { background: rgba(155, 89, 182, 0.2); color: #f1c40f; }
    tr:nth-child(even) { background: rgba(255, 255, 255, 0.03); }
    .tip-box, .warning-box, .note-box {
      padding: 1rem;
      border-radius: 4px;
      margin: 1.5rem 0;
    }
    .tip-box {
      background: rgba(46, 204, 113, 0.12);
      border-left: 4px solid #2ecc71;
    }
    .warning-box {
      background: rgba(231, 76, 60, 0.12);
      border-left: 4px solid #e74c3c;
    }
    .note-box {
      background: rgba(52, 152, 219, 0.12);
      border-left: 4px solid #3498db;
    }
    .syntax-highlight { color: #9cdcfe; }
    .syntax-keyword { color: #c586c0; }
    .syntax-comment { color: #6a9955; font-style: italic; }
    .syntax-number { color: #b5cea8; }
    .syntax-string { color: #ce9178; }
    .shortcut { font-family: 'Fira Code', monospace; background: rgba(255,255,255,0.05); padding: 0.2rem 0.4rem; border-radius: 3px; }
  </style>
</head>
<body>
  <div class="cheatsheet-header">
    <div style="display: flex; align-items: center; gap: 1rem;">
      <img src="../images/logo.png" alt="FreeEd4Med Logo" style="height: 45px;" />
      <div>
        <div style="font-size: 1.2rem; font-weight: bold;">FFmpeg Cheat Sheet</div>
        <small>FreeEd4Med Media SuperTool v10.19</small>
      </div>
    </div>
    <div class="links">
      <a href="../donate.html">üíú Donate</a>
      <a href="../docs/freeed_media_supertool_manual.html">Manual</a>
      <a href="../index.html">‚Üê Back to Site</a>
    </div>
  </div>

  <div class="cheatsheet-container">
    <h1>FFmpeg Cheat Sheet</h1>
    <p>Structured reference guide covering the most important FFmpeg commands used throughout the FreeEd4Med Media SuperTool workflow. Commands are grouped by workflow categories with practical examples, tips, and variations. Use this cheat sheet when scripting repetitive tasks, validating files, or troubleshooting formats.</p>

    <nav class="toc">
      <h3>üìö Quick Navigation</h3>
      <ul>
        <li><a href="#basics">Basics & Diagnostics</a></li>
        <li><a href="#audio">Audio Conversion & Processing</a></li>
        <li><a href="#video">Video Conversion & Encoding</a></li>
        <li><a href="#subtitles">Subtitles & Typography</a></li>
        <li><a href="#visualizers">Visualizers & Waveforms</a></li>
        <li><a href="#social">Social Media Output</a></li>
        <li><a href="#filters">Filters, Metadata, and Utilities</a></li>
        <li><a href="#advanced">Advanced Tips & Optimization</a></li>
      </ul>
    </nav>

    <section id="basics">
      <h2>1. Basics & Diagnostics</h2>

      <h3>1.1 Inspect File Information</h3>
      <pre><code><span class="syntax-comment"># Summarized format info</span>
ffprobe -hide_banner -i input.mp4

<span class="syntax-comment"># JSON output with all streams</span>
ffprobe -loglevel quiet -show_format -show_streams \
        -of json -i input.mp4

<span class="syntax-comment"># Audio-only diagnostic (no video)</span>
ffprobe -select_streams a:0 -show_entries stream=codec_name,channels,sample_rate \
        -of default=noprint_wrappers=1 input.wav</code></pre>

      <h3>1.2 Silence Detection (Quality Control)</h3>
      <pre><code><span class="syntax-comment"># Detect silences longer than 2 seconds below -50 dBFS</span>
ffmpeg -i input.wav -af "silencedetect=noise=-50dB:d=2" -f null -</code></pre>

      <h3>1.3 File Duration</h3>
      <pre><code>ffprobe -i input.mp3 -show_entries format=duration -v quiet -of csv="p=0"</code></pre>

      <div class="note-box">
        For scripting, wrap these commands in bash functions called by the Media SuperTool. Example: <code>get_media_duration() { ffprobe ...; }</code>
      </div>
    </section>

    <section id="audio">
      <h2>2. Audio Conversion & Processing</h2>

      <h3>2.1 Format Conversion</h3>
      <pre><code><span class="syntax-comment"># MP3 ‚Üí WAV (16-bit)</span>
ffmpeg -i song.mp3 -ar 44100 -ac 2 -sample_fmt s16 output.wav

<span class="syntax-comment"># WAV ‚Üí FLAC (lossless)</span>
ffmpeg -i master.wav -compression_level 8 master.flac

<span class="syntax-comment"># WAV ‚Üí AAC (M4A)</span>
ffmpeg -i master.wav -c:a aac -b:a 256k track.m4a</code></pre>

      <h3>2.2 Resampling & Bit Depth</h3>
      <pre><code><span class="syntax-comment"># Convert 48 kHz 32-bit float ‚Üí 44.1 kHz 24-bit integer</span>
ffmpeg -i input.wav -ar 44100 -sample_fmt s32 -c:a pcm_s24le output.wav</code></pre>

      <h3>2.3 Loudness Normalization</h3>
      <pre><code><span class="syntax-comment"># Integrated loudness to -14 LUFS (streaming standard)</span>
ffmpeg -i input.wav -af "loudnorm=I=-14:TP=-1.0:LRA=11" normalized.wav</code></pre>

      <h3>2.4 Extract Audio from Video</h3>
      <pre><code><span class="syntax-comment"># Preserve original codec (copy)</span>
ffmpeg -i video.mp4 -vn -acodec copy audio.aac

<span class="syntax-comment"># Extract as PCM WAV</span>
ffmpeg -i video.mp4 -vn -acodec pcm_s16le audio.wav</code></pre>
    </section>

    <section id="video">
      <h2>3. Video Conversion & Encoding</h2>

      <h3>3.1 Static Image + Audio ‚Üí Video</h3>
      <pre><code>ffmpeg -loop 1 -i artwork.jpg -i track.wav \
  -c:v libx264 -tune stillimage \
  -c:a aac -b:a 320k -shortest -pix_fmt yuv420p video.mp4</code></pre>

      <h3>3.2 Looping Video Clip</h3>
      <pre><code>ffmpeg -stream_loop 3 -i loop.mp4 -i audio.wav \
  -map 0:v -map 1:a -c:v libx264 -shortest export.mp4</code></pre>

      <h3>3.3 Re-encode with Specific Quality</h3>
      <pre><code><span class="syntax-comment"># CRF 18 for visually lossless quality (x264)</span>
ffmpeg -i input.mov -c:v libx264 -crf 18 -preset slow -c:a aac -b:a 192k output.mp4</code></pre>

      <div class="tip-box">
        CRF (Constant Rate Factor) scale: 17-20 = High quality, 21-24 = Balanced, 25+ = Low quality. Lower CRF = higher quality/larger file.
      </div>

      <h3>3.4 Resize Video</h3>
      <pre><code>ffmpeg -i input.mp4 -vf "scale=1280:720:force_original_aspect_ratio=decrease,
                       pad=1280:720:(ow-iw)/2:(oh-ih)/2" output_720p.mp4</code></pre>
    </section>

    <section id="subtitles">
      <h2>4. Subtitles & Typography</h2>

      <h3>4.1 Burn Subtitles (ASS styling)</h3>
      <pre><code><span class="syntax-comment"># Force specific styling when burning subtitles</span>
ffmpeg -i video.mp4 -vf "subtitles=lyrics.ass:force_style='FontName=Arial,FontSize=32,
                PrimaryColour=&H00FFFFFF,OutlineColour=&H00000000,MarginV=40'" \
                -c:a copy final.mp4</code></pre>

      <h3>4.2 Convert SRT ‚Üí ASS with Aegisub</h3>
      <div class="note-box">
        Use Aegisub for full styling control. Save as .ASS. The Media SuperTool's typography engine automatically writes ASS force_style parameters.
      </div>

      <h3>4.3 Subtitle Delay Compensation</h3>
      <pre><code><span class="syntax-comment"># Shift subtitles by +500ms and burn into video</span>
ffmpeg -i video.mp4 -vf "subtitles=lyrics.srt:si=0:original_size=1920x1080:force_style='MarginV=50':
      fontsdir=/path/to/fonts,subdelay=500" -c:a copy output.mp4</code></pre>
    </section>

    <section id="visualizers">
      <h2>5. Visualizers & Waveforms</h2>

      <h3>5.1 Circular Waveform ("Portal")</h3>
      <pre><code>ffmpeg -i audio.wav -loop 1 -i background.jpg \
  -filter_complex "[0:a]aformat=channel_layouts=mono,showwaves=s=1280x720:mode=cline:colors=violet,
  geq='p(mod(W/PI*(PI+atan2(H/2-Y,X-W/2)),W),H-2*hypot(H/2-Y,X-W/2))':
  a='alpha(mod(W/PI*(PI+atan2(H/2-Y,X-W/2)),W),H-2*hypot(H/2-Y,X-W/2))'[w];
  [1:v][w]overlay=(W-w)/2:(H-h)/2:shortest=1" \
  -c:v libx264 -c:a copy portal.mp4</code></pre>

      <h3>5.2 Spectrum Analyzer (Scrolling)</h3>
      <pre><code>ffmpeg -i audio.wav -filter_complex "showspectrum=slide=scroll:mode=combined:color=magma:
          scale=log:fscale=log:s=1920x1080" -c:v libx264 -c:a copy spectrum.mp4</code></pre>

      <h3>5.3 Waveform Thumbnails</h3>
      <pre><code><span class="syntax-comment"># Transparent background waveform</span>
ffmpeg -i audio.wav -filter_complex "aformat=channel_layouts=mono,
            showwavespic=s=1280x720:colors=white" -frames:v 1 waveform.png</code></pre>
    </section>

    <section id="social">
      <h2>6. Social Media Output</h2>

      <h3>6.1 TikTok Vertical Video</h3>
      <pre><code>ffmpeg -i horizontal.mp4 -vf "split[main][copy];
  [copy]scale=-1:1920,boxblur=20:20[bg];
  [bg]crop=1080:1920[blur];
  [blur][main]overlay=(W-w)/2:(H-h)/2" \
  -c:v libx264 -c:a aac tiktok.mp4</code></pre>

      <h3>6.2 YouTube Master</h3>
      <pre><code>ffmpeg -i master.mov -c:v libx264 -preset slow -crf 18 \
  -pix_fmt yuv420p -c:a aac -b:a 320k youtube.mp4</code></pre>

      <h3>6.3 X (Twitter) Optimized</h3>
      <pre><code>ffmpeg -i input.mp4 -c:v libx264 -pix_fmt yuv420p \
  -preset medium -b:v 3500k -maxrate 3500k -bufsize 7000k -c:a aac -b:a 160k twitter.mp4</code></pre>
    </section>

    <section id="filters">
      <h2>7. Filters, Metadata, and Utilities</h2>

      <h3>7.1 Color Channel Mixer (Watermark transparency)</h3>
      <pre><code>ffmpeg -i video.mp4 -i logo.png -filter_complex "[1]format=rgba,
  colorchannelmixer=aa=0.5[logo]; [0][logo]overlay=10:10" -c:a copy output.mp4</code></pre>

      <h3>7.2 Metadata Editing</h3>
      <pre><code>ffmpeg -i input.flac -map_metadata 0 \
  -metadata title="Song Title" \
  -metadata artist="Artist Name" \
  -metadata album="Album Name" \
  -metadata date="2025" \
  -c copy output.flac</code></pre>

      <h3>7.3 Thumbnail Extraction</h3>
      <pre><code><span class="syntax-comment"># Capture frame at 15 seconds</span>
ffmpeg -ss 00:00:15 -i video.mp4 -frames:v 1 thumbnail.png</code></pre>
    </section>

    <section id="advanced">
      <h2>8. Advanced Tips & Optimization</h2>

      <h3>8.1 FFmpeg Preset Reference (x264)</h3>
      <table>
        <tr><th>Preset</th><th>Speed</th><th>Quality/File Size</th></tr>
        <tr><td>ultrafast</td><td>Fastest</td><td>Lowest quality (large files)</td></tr>
        <tr><td>superfast</td><td>Very fast</td><td>Low quality</td></tr>
        <tr><td>faster</td><td>Fast</td><td>Moderate quality</td></tr>
        <tr><td>medium</td><td>Default</td><td>Balanced</td></tr>
        <tr><td>slow</td><td>Slow</td><td>High quality (smaller files)</td></tr>
        <tr><td>veryslow</td><td>Slowest</td><td>Best quality (smallest files)</td></tr>
      </table>

      <div class="tip-box">
        Use <code>-preset slow</code> for final masters (YouTube, archival). Use <code>-preset faster</code> for previews or quick iterations.
      </div>

      <h3>8.2 Two-Pass Encoding (Bitrate Control)</h3>
      <pre><code><span class="syntax-comment"># Pass 1</span>
ffmpeg -y -i input.mp4 -c:v libx264 -b:v 4000k -pass 1 -an -f mp4 /dev/null

<span class="syntax-comment"># Pass 2</span>
ffmpeg -i input.mp4 -c:v libx264 -b:v 4000k -pass 2 -c:a aac -b:a 192k output.mp4</code></pre>

      <h3>8.3 Hardware Acceleration (NVENC Example)</h3>
      <pre><code>ffmpeg -i input.mp4 -c:v h264_nvenc -preset slow -rc vbr -cq 19 -b:v 5M -maxrate 7M \
  -c:a aac -b:a 192k output_nvenc.mp4</code></pre>

      <h3>8.4 Batch Conversion Script (Audio)</h3>
      <pre><code><span class="syntax-comment">#!/bin/bash</span>
for file in *.wav; do
  base=${file%.*}
  ffmpeg -i "$file" -ar 44100 -ac 2 -c:a libmp3lame -b:a 256k "$base.mp3"
done</code></pre>

      <div class="warning-box">
        When batch-processing, always test with a single file first. FFmpeg will overwrite existing files without prompting unless you add <span class="shortcut">-n</span> (fail if exists) or <span class="shortcut">-y</span> (overwrite) flags explicitly.
      </div>
    </section>

    <hr style="border-color: rgba(255,255,255,0.05); margin: 3rem 0;" />

    <footer style="text-align: center; color: #999; padding-bottom: 2rem;">
      <p>FreeEd4Med Media SuperTool v10.19 ‚Äî FFmpeg Cheat Sheet</p>
      <p>&copy; 2025 FreeEd4Med.org ‚Äî Music for Healing</p>
      <p><a href="../donate.html" style="color: #f1c40f; text-decoration: none;">Support the mission</a></p>
    </footer>
  </div>
</body>
</html>
